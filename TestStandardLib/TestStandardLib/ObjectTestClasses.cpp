#include "StandardLib/ObjectSerialiser.h"
#include "ObjectTestClasses.h"


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CTestObject::Init(STestObjectKilledNotifier* psKilledNotifier)
{
	mpsKilledNotifier = psKilledNotifier;
	mpsKilledNotifier->bKilled = FALSE;
	mpObject.Init(this);
	mpTest.Init(this);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CTestObject::Kill(void)
{
	CObject::Kill();
	mpsKilledNotifier->bKilled = TRUE;
}



//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
BOOL CTestObject::Save(CObjectSerialiser* pcFile)
{
	return FALSE;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
BOOL CTestObject::Load(CObjectDeserialiser* pcFile)
{
	return FALSE;
}

//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CTestSaveableObject1::Init()
{
	miInt = 7;
	mszString.Init();
	mbSaved = FALSE;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CTestSaveableObject1::Kill(void)
{
	mszString.Kill();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
BOOL CTestSaveableObject1::Save(CObjectSerialiser* pcFile)
{
	ReturnOnFalse(SaveHeader(pcFile));

	ReturnOnFalse(pcFile->WritePointer(mpObject));
	ReturnOnFalse(pcFile->WriteInt(miInt));
	ReturnOnFalse(pcFile->WriteString(&mszString));

	mbSaved = TRUE;
	return TRUE;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
BOOL CTestSaveableObject1::Load(CObjectDeserialiser* pcFile)
{
	return FALSE;
}

//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CTestSaveableObject2::Init(char* psz)
{
	mpsz = psz;
	mbSaved = FALSE;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CTestSaveableObject2::Kill(void)
{
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
BOOL CTestSaveableObject2::Save(CObjectSerialiser* pcFile)
{
	ReturnOnFalse(SaveHeader(pcFile));

	pcFile->WriteString(mpsz);
	pcFile->WritePointer(mp1);
	pcFile->WritePointer(mp2);
	mbSaved = TRUE;
	return TRUE;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
BOOL CTestSaveableObject2::Load(CObjectDeserialiser* pcFile)
{
	return FALSE;
}


