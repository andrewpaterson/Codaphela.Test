#include "StandardLib/ClassDefines.h"
#include "EmbeddedObjectTestClasses.h"


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CEmbeddedTest::Class(void)
{
	U_SInt(miAmANumber);
	U_Float32(mfSoAmI);
	M_Pointer(mpTest);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
Ptr<CEmbeddedTest> CEmbeddedTest::Init(void)
{
	PreInit();
	miAmANumber = 85;
	mfSoAmI = 58.0f;

	PostInit();
	return Ptr<CEmbeddedTest>(this);
}

//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CEmbeddedTest::Free(void)
{
	miAmANumber = 0;
	mfSoAmI = 0.0f;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CEmbeddedTest::Save(CObjectWriter* pcFile)
{
	pcFile->WriteInt32(miAmANumber);
	pcFile->WriteFloat(mfSoAmI);

	return true;
}

//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CEmbeddedTest::Load(CObjectReader* pcFile)
{
	pcFile->ReadInt32(&miAmANumber);
	pcFile->ReadFloat(&mfSoAmI);
	
	return true;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CEmbeddedContainer::Class(void)
{
	U_CharArray(msz, 4);
	M_Pointer(mpTest);
	M_Embedded(mcOne);
	M_Embedded(mcTwo);
	U_SInt(mi);
	U_Float32(mf);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
Ptr<CEmbeddedContainer> CEmbeddedContainer::Init(void)
{
	PreInit();
	strcpy(msz, "And");
	mcOne.Init();
	mi = 73;
	mcTwo.Init();
	mf = 666.0f;

	PostInit();
	return Ptr<CEmbeddedContainer>(this);
}

//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CEmbeddedContainer::Free(void)
{
	msz[0] = msz[1] = msz[2] = msz[3] = 0;
	mi = 0;
	mf = 0.0f;
}

//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CEmbeddedContainer::Save(CObjectWriter* pcFile)
{
	pcFile->WriteData(msz, 4);
	pcFile->WriteInt32(mi);
	pcFile->WriteFloat(mf);

	return true;
}

//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CEmbeddedContainer::Load(CObjectReader* pcFile)
{
	pcFile->ReadData(msz, 4);
	pcFile->ReadInt32(&mi);
	pcFile->ReadFloat(&mf);

	return true;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CEmbeddedComplex::Class(void)
{
	M_Pointer(mpTest);
	U_Int32Array(mai, 2);
	M_Embedded(mcSimple);
	M_Embedded(ma);
	M_Embedded(mcContainer);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
Ptr<CEmbeddedComplex> CEmbeddedComplex::Init(void)
{
	PreInit();
	mcSimple.Init();
	mai[0] = 1;
	mai[1] = 2;
	ma.Init();
	mcContainer.Init();

	PostInit();
	return Ptr<CEmbeddedComplex>(this);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CEmbeddedComplex::Free(void)
{
	mai[0] = 0;
	mai[1] = 0;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CEmbeddedComplex::Save(CObjectWriter* pcFile)
{
	pcFile->WriteInt32(mai[0]);
	pcFile->WriteInt32(mai[1]);

	return true;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CEmbeddedComplex::Load(CObjectReader* pcFile)
{
	pcFile->ReadInt32(&mai[0]);
	pcFile->ReadInt32(&mai[1]);

	return true;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CEmbeddedComplex::Add(Ptr<> pObject)
{
	ma.Add(pObject);
}

